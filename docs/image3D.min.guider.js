
    /*!
    * image3D - üçä ‰ΩøÁî®webGLÁªòÂà∂‰∏âÁª¥ÂõæÁâá„ÄÇDrawing three-dimensional images using webGL.
    * git+https://github.com/yelloxing/image3D.git
    *
    * author ÂøÉÂè∂
    *
    * version 0.1.0-alpha
    *
    * build Thu Apr 11 2019
    *
    * Copyright yelloxing
    * Released under the MIT license
    *
    * Date:Fri Sep 06 2019 23:27:32 GMT+0800 (‰∏≠ÂõΩÊ†áÂáÜÊó∂Èó¥)
    */

"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};(function(){"use strict";var u=function r(t,e,n){var o=t.createShader(e);if(o==null)throw new Error("Unable to create shader!");t.shaderSource(o,n);t.compileShader(o);if(!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Failed to compile shader:"+t.getShaderInfoLog(o));return o};var n=function r(t,e,n){var o=u(t,t.VERTEX_SHADER,e),i=u(t,t.FRAGMENT_SHADER,n);var a=t.createProgram();t.attachShader(a,o);t.attachShader(a,i);t.linkProgram(a);if(!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("Failed to link program: "+t.getProgramInfoLog(a));t.useProgram(a);return a};var e=function r(t,e){var n=t.createBuffer(),o=e?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;t.bindBuffer(o,n);return n};var i=function r(t,e,n,o){var i=o?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;t.bufferData(i,e,n)};var v=function r(t,e,n,o,i,a,u){t.vertexAttribPointer(e,n,o,u||false,i||0,a||0);t.enableVertexAttribArray(e)};var a=function r(t,e){t.deleteBuffer(e)};var f=function r(t,e,n){var o=t.createTexture();t.activeTexture(t["TEXTURE"+e]);t.bindTexture(n,o);return o};var c=function r(t,e,n){var o=void 0;for(o in n){t.texParameteri(e,t[o],t[n[o]])}};var l=function r(t,e,n,o,i,a){t.texImage2D(e,n,o,o,i,a)};var p=function r(t,e){t.deleteTexture(e)};function o(r){var t=typeof r==="undefined"?"undefined":_typeof(r);return r!=null&&(t==="object"||t==="function")}var t=function r(t,e){var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o=null,i=void 0;for(i=0;i<n.length;i++){try{o=t.getContext(n[i],e)}catch(r){}if(o)break}return o};var d=function r(t){return new r.prototype.init(t)};d.prototype.init=function(r){this[0]=r;return this};d.prototype.extend=d.extend=function(){var r=arguments[0]||{};var t=arguments[1]||{};var e=arguments.length;if(e===1){t=r;r=this}if(!o(r)){r={}}for(var n in t){try{r[n]=t[n]}catch(r){throw new Error("Illegal property valueÔºÅ")}}return r};d.prototype.init.prototype=d.prototype;d.prototype.render3D=function(r){var d=t(this[0],r),o={painter:function r(){return d},shader:function r(t,e){d.program=n(d,t,e);return o},buffer:function t(n){var t=e(d,n),f=void 0,c={write:function r(t,e){e=e||d.STATIC_DRAW;i(d,t,e,n);f=t;return c},use:function r(t,e,n,o,i,a){var u=f.BYTES_PER_ELEMENT;if(typeof t=="string")t=d.getAttribLocation(d.program,t);n=n||0;o=o||0;i=i||d.FLOAT;v(d,t,e,i,n*u,o*u,a);return c},close:function r(){a(d,t);return o}};return c},texture:function t(r,i){i=i||d.TEXTURE_2D;var t=f(d,r,i);var a={config:function r(t){c(d,i,t);return a},use:function r(t,e,n,o){l(d,i,t,e,n,o);return a},close:function r(){p(d,t);return o}};return a}};return o};function m(r,t,e,n){n=n||0;var o=Math.sqrt(t*t+e*e+n*n);return[1,0,0,0,0,1,0,0,0,0,1,0,t*r/o,e*r/o,n*r/o,1]}function s(r){var t=Math.sin(r),e=Math.cos(r);return[e,t,0,0,-t,e,0,0,0,0,1,0,0,0,0,1]}function w(r,t,e,n,o,i){n=n||0;o=o||0;i=i||0;return[r,0,0,0,0,t,0,0,0,0,e,0,n-n*r,o-o*t,i-i*e,1]}function y(r,t,e,n,o,i){if(typeof r==="number"&&typeof t==="number"){if(typeof e!=="number"){e=0;n=r;o=t;i=1}else if(typeof n!=="number"||typeof o!=="number"||typeof i!=="number"){n=r;o=t;i=e;r=0;t=0;e=0}if(r==n&&t==o&&e==i)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((n-r)*(n-r)+(o-t)*(o-t)),u=a!=0?(o-t)/a:1,f=a!=0?(n-r)/a:0,c=(n-r)*f+(o-t)*u,d=i-e,v=Math.sqrt(c*c+d*d),l=v!=0?d/v:1,p=v!=0?c/v:0;return[[u,l*f,f*p,0,-f,u*l,u*p,0,0,-p,l,0,t*f-r*u,e*p-r*f*l-t*u*l,-r*f*p-t*u*p-e*l,1],[u,-f,0,0,l*f,l*u,-p,0,f*p,u*p,l,0,r,t,e,1]]}else{throw new Error("a1 and b1 is required!")}}var h=function r(t,e){var n=[];for(var o=0;o<4;o++){for(var i=0;i<e.length/4;i++){n[i*4+o]=t[o]*e[i*4]+t[o+4]*e[i*4+1]+t[o+8]*e[i*4+2]+t[o+12]*e[i*4+3]}}return n};function r(r){var c=r||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var d={move:function r(t,e,n,o){c=h(m(t,e,n,o),c);return d},rotate:function r(t,e,n,o,i,a,u){var f=y(e,n,o,i,a,u);c=h(h(h(f[1],s(t)),f[0]),c);return d},scale:function r(t,e,n,o,i,a){c=h(w(t,e,n,o,i,a),c);return d},multiply:function r(t,e){c=e?h(c,t):h(t,c);return d},use:function r(t,e,n,o){n=n||0;o=o||1;var i=h(c,[t,e,n,o]);i[0]=+i[0].toFixed(7);i[1]=+i[1].toFixed(7);i[2]=+i[2].toFixed(7);i[3]=+i[3].toFixed(7);return i},value:function r(){return c}};return d}var g=[];var b=13;var E=400;var T=null;function x(t,r,e){var f={timer:function r(t,e,n){if(!t){throw new Error("Tick is required!")}e=e||E;var o=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);g.push({id:o,createTime:new Date,tick:t,duration:e,callback:n});f.start();return o},start:function r(){if(!T){T=window.setInterval(f.tick,b)}},tick:function r(){var t=void 0,e=void 0,r=void 0,n=void 0,o=void 0,i=void 0,a=void 0,u=g;g=[];g.length=0;for(e=0;e<u.length;e++){o=u[e];t=o.createTime;r=o.tick;i=o.duration;n=o.callback;a=(+new Date-t)/i;a=a>1?1:a;r(a);if(a<1&&o.id){g.push(o)}else if(n){n(a)}}if(g.length<=0){f.stop()}},stop:function r(){if(T){window.clearInterval(T);T=null}}};var n=f.timer(function(r){t(r)},r,e);return function(){var r=void 0;for(r in g){if(g[r].id==n){g[r].id=undefined;return}}}}d.extend({Matrix4:r,animation:x});d.prototype.extend({});d.fn=d.prototype;if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=d}else{var A=window.image3D,R=window.$$;d.noConflict=function(r){if(window.$$===d){window.$$=R}if(r&&window.image3D===d){window.image3D=A}return d};window.image3D=window.$$=d}})();